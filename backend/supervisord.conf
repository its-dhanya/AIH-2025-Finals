[supervisord]
nodaemon=true
logfile=/tmp/supervisord.log
loglevel=info

[supervisorctl]
serverurl=unix:///tmp/supervisor.sock

[unix_http_server]
file=/tmp/supervisor.sock

[rpcinterface:supervisor]
supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface

[program:uvicorn]
; use python -m uvicorn so it uses the environment's uvicorn module reliably
command=/usr/local/bin/python -m uvicorn main:app --host 0.0.0.0 --port 3000 --workers 1
directory=/app
autostart=true
autorestart=true
stdout_logfile=/tmp/uvicorn.stdout.log
stderr_logfile=/tmp/uvicorn.stderr.log
startretries=3
startsecs=2

[program:frontend_static]
; Serve the built frontend on port 3000 using python's http.server
command=/usr/local/bin/python -m http.server 8080
directory=/app/frontend_build
autostart=true
autorestart=true
stdout_logfile=/tmp/frontend.stdout.log
stderr_logfile=/tmp/frontend.stderr.log
startretries=3
startsecs=2